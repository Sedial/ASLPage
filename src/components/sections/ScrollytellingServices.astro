---
import Button from '../ui/Button.astro';

// Datos de servicios logísticos de ASL - Información real de la empresa
const services = [
  {
    id: 'intro',
    title: 'ASL - Agencia de Servicios Logísticos',
    subtitle: 'Operadores logísticos especializados en soluciones 3PL',
    description: 'ASL - Agencia de Servicios Logísticos S.A. es una empresa que nace de la unión de conocimientos y experiencia de operadores logísticos de Bavaria. Tenemos presencia estratégica en múltiples departamentos: Córdoba, Nariño, Huila, Antioquia, Tolima, Cundinamarca, Valle del Cauca, Risaralda, Boyacá y Atlántico.',
    background: 'bg-white',
    textColor: 'text-gray-900',
    icon: '🚛',
    stats: [
      { number: 'Bavaria', label: 'Experiencia con' },
      { number: '10', label: 'Departamentos' },
      { number: '100%', label: 'Soluciones integrales' }
    ]
  },
  {
    id: 'recepcion-despacho',
    title: 'Recepción y Despacho de Mercancías',
    subtitle: 'Gestión eficiente de entrada y salida',
    description: 'Procesos optimizados para la recepción, verificación y despacho de mercancías con tecnologías apropiadas que aseguran la generación de valor agregado en la cadena de abastecimiento.',
    background: 'bg-white',
    textColor: 'text-gray-900',
    icon: '📦',
    features: [
      'Recepción con verificación completa',
      'Despacho programado y eficiente',
      'Control de calidad en cada proceso',
      'Documentación completa',
      'Trazabilidad total de mercancías'
    ]
  },
  {
    id: 'almacenamiento',
    title: 'Almacenamiento',
    subtitle: 'Gestión profesional de inventarios',
    description: 'Servicios de almacenamiento con personal experto y tecnologías apropiadas que aseguran la generación de valor agregado, ofreciendo soluciones integrales a la medida de nuestros clientes.',
    background: 'bg-white',
    textColor: 'text-gray-900',
    icon: '🏢',
    features: [
      'Almacenes especializados',
      'Control de inventarios en tiempo real',
      'Gestión FIFO y LIFO',
      'Seguridad y protección de mercancías',
      'Optimización de espacios'
    ]
  },
  {
    id: 'picking-packing',
    title: 'Picking y Packing',
    subtitle: 'Preparación especializada de pedidos',
    description: 'Servicios de picking y packing con operaciones in house distribuidas por agrega valor en la cadena de abastecimiento, al efectuar entregas perfectas, con mínimos costos y tiempos justos.',
    background: 'bg-white',
    textColor: 'text-gray-900',
    icon: '📋',
    features: [
      'Picking optimizado por zonas',
      'Packing personalizado',
      'Control de calidad en empaque',
      'Etiquetado especializado',
      'Preparación de pedidos express'
    ]
  },
  {
    id: 'armado-ofertas',
    title: 'Armado de Ofertas',
    subtitle: 'Servicios de valor agregado',
    description: 'Armado especializado de ofertas y promociones, permitiendo convertimos en un socio estratégico para nuestros clientes, asegurando su rentabilidad y satisfacción a través de nuestras operaciones.',
    background: 'bg-white',
    textColor: 'text-gray-900',
    icon: '🎁',
    features: [
      'Armado de promociones especiales',
      'Kits personalizados',
      'Empaque promocional',
      'Control de fechas de vencimiento',
      'Gestión de ofertas estacionales'
    ]
  },
  {
    id: 'administracion-inventarios',
    title: 'Administración y Manejo de Inventarios',
    subtitle: 'Control total de tu stock',
    description: 'Administración completa de inventarios con personal experto y tecnologías apropiadas, ofreciendo soluciones integrales a la medida de nuestros clientes con mínimos costos y tiempos justos.',
    background: 'bg-white',
    textColor: 'text-gray-900',
    icon: '📊',
    features: [
      'Sistema WMS avanzado',
      'Reportes en tiempo real',
      'Control de rotación de inventarios',
      'Gestión de obsoletos',
      'Optimización de stock'
    ]
  },
  {
    id: 'operacion-in-home',
    title: 'Operación Logística In Home',
    subtitle: 'Soluciones logísticas en sitio',
    description: 'Operaciones logísticas especializadas in home que permiten a nuestros clientes enfocarse en su core business mientras nosotros gestionamos eficientemente su cadena de suministro.',
    background: 'bg-white',
    textColor: 'text-gray-900',
    icon: '🏠',
    features: [
      'Operaciones en las instalaciones del cliente',
      'Personal especializado dedicado',
      'Gestión integral de procesos',
      'Adaptación a necesidades específicas',
      'Optimización de recursos del cliente'
    ]
  },
  {
    id: 'contacto',
    title: '¿Listo para optimizar tu logística?',
    subtitle: 'Comencemos a trabajar juntos',
    description: 'Solicita una consultoría gratuita y descubre cómo ASL puede transformar tu cadena de suministro con soluciones a la medida de tus necesidades específicas.',
    background: 'bg-white',
    textColor: 'text-gray-900',
    icon: '🚀',
    contact: true
  }
];

// Mapeo de iconos (ubicados en /public/icons)
const iconMap: Record<string, string> = {
  intro: 'truck-logistics.webp',
  'recepcion-despacho': 'warehouse-box.webp',
  almacenamiento: 'wms-icon.webp',
  'picking-packing': 'ecommerce-cart.webp',
  'armado-ofertas': 'ai-optimization-icon.webp',
  'administracion-inventarios': 'tracking-icon.webp',
  'operacion-in-home': 'security-icon.webp',
  contacto: 'rocket-launch.webp',
};

// Mapeo de imágenes (ubicadas en /public/images/services/intro)
const imageMap: Record<string, string> = {
  intro: 'logistics.webp',
  'recepcion-despacho': 'automated-warehouse-interior.webp',
  almacenamiento: 'colombia-distribution-map.webp',
  'picking-packing': 'ecommerce-fulfillment-center.webp',
  'armado-ofertas': 'logistics-tech-dashboard.webp',
  'administracion-inventarios': 'asl-professional-team.webp',
  'operacion-in-home': 'logistics-center-aerial.webp',
  contacto: 'asl-professional-team.webp',
};

const getIconSrc = (id: string) => `/icons/${iconMap[id] ?? 'truck-logistics.webp'}`;
const getImageSrc = (id: string) => {
  // Verificar si la imagen existe en el mapa
  const imageName = imageMap[id] ?? 'logistics-center-aerial.webp';
  // Asegurar que la ruta sea correcta y esté bien formada
  return `/images/services/intro/${imageName}`;
};
---

<div class="scrollytelling-container relative">
  <!-- Indicadores de navegación -->
  <div class="fixed right-4 md:right-6 lg:right-8 top-1/2 transform -translate-y-1/2 z-40 hidden md:flex flex-col space-y-3 md:space-y-4">
    {services.map((service, index) => (
      <button 
        class="nav-dot w-3 h-3 md:w-4 md:h-4 rounded-full bg-gray-400/70 hover:bg-primary-500 transition-all duration-300 cursor-pointer focus:outline-none focus:ring-2 focus:ring-primary-500/50 transform hover:scale-125"
        data-target={service.id}
        aria-label={`Ir a ${service.title}`}
      ></button>
    ))}
  </div>

  <!-- Secciones de scrollytelling -->
  {services.map((service, index) => (
    <section 
      id={service.id}
      class={`scrolly-section min-h-screen flex items-center justify-center relative ${service.background} ${service.textColor} section-parallax ${index === 0 ? 'pt-20' : ''}`}
      data-section={service.id}
      data-index={index}
    >
      <!-- Acento lateral animado -->
      <div class="absolute left-0 top-0 bottom-0 w-2 bg-primary-500 z-[1] hidden md:block section-accent transform scale-y-0 origin-top"></div>
      
      <!-- Contenido principal -->
      <div class="container mx-auto px-4 relative z-10 py-24 md:py-28">
        <div class="max-w-6xl mx-auto">
          
          {service.id === 'intro' && (
            <div class="text-center space-y-12 relative">
              <!-- Logo como fondo del div central -->
              <div class="absolute inset-0 flex items-center justify-center opacity-5 pointer-events-none">
                <img 
                  srcset="/images/logo2.webp 384w, /images/logo2.webp 512w"
                  sizes="384px"
                  width="384"
                  height="384"
                  src="/images/logo2.webp" 
                  alt="ASL Logo" 
                  class="w-96 h-96 object-contain" 
                />
              </div>
              <h1 class="text-4xl sm:text-5xl md:text-6xl lg:text-7xl xl:text-8xl font-black mb-6 leading-tight text-primary-500" data-animate="title-slide" data-delay="200">
                {service.title}
              </h1>
              <div class="h-2 w-24 sm:w-32 bg-primary-500 mx-auto rounded-full transform scale-x-0" data-animate="line-expand" data-delay="400"></div>
              <p class="text-xl sm:text-2xl md:text-3xl lg:text-4xl font-light mt-6 opacity-90 text-primary-400" data-animate="subtitle-fade" data-delay="600">
                {service.subtitle}
              </p>
              <p class="text-lg sm:text-xl md:text-2xl lg:text-3xl max-w-4xl mx-auto leading-relaxed opacity-80" data-animate="desc-rise" data-delay="800">
                {service.description}
              </p>
              
              <!-- Stats con animaciones escalonadas -->
              <div class="grid grid-cols-3 gap-12 mt-20 max-w-4xl mx-auto">
                {service.stats?.map((stat, statIndex) => (
                  <div class="text-center" data-animate="stat-pop" data-delay={1000 + (statIndex * 200)}>
                    <div class="text-5xl md:text-6xl font-black text-primary-500 mb-3 transform scale-0">{stat.number}</div>
                    <div class="text-xl font-semibold opacity-90">{stat.label}</div>
                  </div>
                ))}
              </div>
              
              <!-- Imagen principal de introducción -->
              <div class="mt-20 opacity-100" data-animate="fade-in" data-delay="800">
                <div class="relative max-w-5xl mx-auto">
                  <img 
                    src="/images/services/intro/logistics.webp" 
                    alt="Centro logístico de ASL - Vista aérea" 
                    class="w-full h-auto rounded-2xl shadow-2xl border border-primary-500/10 hover:shadow-3xl transition-all duration-500" 
                    width="1200" 
                    height="600" 
                    loading="eager" 
                    decoding="sync"
                  />
                  <div class="absolute inset-0 bg-gradient-to-t from-black/10 to-transparent rounded-2xl pointer-events-none"></div>
                </div>
              </div>
            </div>
          )}

          {service.id !== 'intro' && service.id !== 'contacto' && (
            <div class="grid lg:grid-cols-2 gap-20 items-center">
              <!-- Contenido textual -->
              <div class="space-y-10">
                <img src={getIconSrc(service.id)} alt={service.title} class="mb-6 icon-float w-12 h-12 md:w-16 md:h-16 lg:w-20 lg:h-20 object-contain" data-animate="icon-spin" data-delay="0" width="80" height="80" loading="lazy" decoding="async" />
                <h2 class="text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-black leading-tight text-primary-500 transform -translate-x-12 opacity-0" data-animate="title-sweep" data-delay="200">
                  {service.title}
                </h2>
                <div class="h-2 w-20 sm:w-24 bg-primary-500 rounded-full transform scale-x-0 origin-left" data-animate="line-expand" data-delay="400"></div>
                <p class="text-xl sm:text-2xl md:text-3xl font-light opacity-90 text-primary-400 transform translate-y-8 opacity-0" data-animate="subtitle-rise" data-delay="600">
                  {service.subtitle}
                </p>
                <p class="text-lg sm:text-xl md:text-2xl leading-relaxed opacity-80 transform translate-y-12 opacity-0" data-animate="desc-fade" data-delay="800">
                  {service.description}
                </p>
                
                <!-- Lista de características con diseño responsivo -->
                {service.features && (
                  <div class="relative w-full max-w-5xl mx-auto mt-16 mb-16">
                    <!-- Diseño circular SOLO para la sección de almacenamiento -->
                    {service.id === 'almacenamiento' && (
                    <div class="hidden md:block relative w-96 h-96 lg:w-[550px] lg:h-[550px] mx-auto">
                      <!-- Centro del círculo (fijo, no gira) -->
                      <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-30">
                           <img 
                             srcset="/images/logo2.webp 128w, /images/logo2.webp 160w"
                             sizes="(min-width: 1024px) 160px, 128px"
                             width="160"
                             height="160"
                             src="/images/logo2.webp" 
                             alt="ASL Logo" 
                             class="w-32 h-32 lg:w-40 lg:h-40 object-contain" 
                           />
                       </div>
                      
                      <!-- Contenedor giratorio para las tarjetas -->
                      <div class="circular-container absolute inset-0">
                        {service.features.map((feature, featureIndex) => {
                          const angle = (360 / service.features.length) * featureIndex;
                          const radius = 160; // Radio aumentado para evitar superposición
                          const x = Math.cos((angle - 90) * Math.PI / 180) * radius;
                          const y = Math.sin((angle - 90) * Math.PI / 180) * radius;
                         
                         return (
                           <div 
                             class="absolute w-32 h-32 lg:w-36 lg:h-36 bg-white rounded-full shadow-xl border-3 border-primary-200 flex items-center justify-center transform -translate-x-1/2 -translate-y-1/2 hover:scale-110 transition-all duration-300 cursor-pointer group feature-card hover:shadow-2xl hover:border-primary-400"
                             style={`left: calc(50% + ${x}px); top: calc(50% + ${y}px); animation-delay: ${featureIndex * 200}ms;`}
                             data-animate="circular-appear"
                             data-delay={1000 + (featureIndex * 200)}
                           >
                             <div class="text-center p-3 card-content">
                                <div class="w-4 h-4 bg-primary-500 rounded-full mx-auto mb-2 group-hover:animate-bounce"></div>
                                <span class="text-sm lg:text-base font-bold text-gray-800 leading-tight block">{feature.split(' ').slice(0, 2).join(' ')}</span>
                                {feature.split(' ').length > 2 && (
                                  <span class="text-xs text-gray-600 block mt-1">{feature.split(' ').slice(2).join(' ')}</span>
                                )}
                              </div>
                           </div>
                         );
                       })}
                      </div>
                    </div>
                    )}
                    
                    <!-- Diseño de grid para móviles y tablets (almacenamiento) -->
                    {service.id === 'almacenamiento' && (
                    <div class="md:hidden grid grid-cols-2 sm:grid-cols-3 gap-4 sm:gap-6">
                      {service.features.map((feature, featureIndex) => (
                        <div 
                          class="bg-white rounded-xl p-4 shadow-lg border-2 border-primary-200 hover:border-primary-400 hover:shadow-xl transition-all duration-300 transform hover:scale-105"
                          data-animate="card-slide"
                          data-delay={1000 + (featureIndex * 100)}
                        >
                          <div class="text-center">
                            <div class="w-3 h-3 bg-primary-500 rounded-full mx-auto mb-3"></div>
                            <span class="text-sm font-bold text-gray-800 leading-tight block">{feature}</span>
                          </div>
                        </div>
                      ))}
                    </div>
                    )}
                    
                    <!-- Diseño de lista simple para otras secciones -->
                    {service.id !== 'almacenamiento' && (
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6">
                      {service.features.map((feature, featureIndex) => (
                        <div 
                          class="bg-white rounded-xl p-4 shadow-lg border-2 border-primary-200 hover:border-primary-400 hover:shadow-xl transition-all duration-300 transform hover:scale-105"
                          data-animate="card-slide"
                          data-delay={1000 + (featureIndex * 100)}
                        >
                          <div class="text-center">
                            <div class="w-3 h-3 bg-primary-500 rounded-full mx-auto mb-3"></div>
                            <span class="text-sm font-bold text-gray-800 leading-tight block">{feature}</span>
                          </div>
                        </div>
                      ))}
                    </div>
                     )}
                   </div>
                 )}

                {service.coverage && (
                  <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6 mt-12">
                    {service.coverage.map((location, locationIndex) => {
                      const backgroundImages = {
                        'Bogotá y Cundinamarca': '/images/cities/bogota-cundinamarca-bg.webp',
                        'Medellín y Antioquia': '/images/cities/medellin-antioquia-bg.webp',
                        'Cali y Valle del Cauca': '/images/cities/cali-valle-bg.webp',
                        'Barranquilla y Costa Atlántica': '/images/cities/barranquilla-costa-bg.webp',
                        'Bucaramanga y Santanderes': '/images/cities/bucaramanga-santanderes-bg.webp',
                        'Cobertura nacional completa': '/images/cities/cobertura-nacional-bg.webp'
                      };
                      const bgImage = backgroundImages[location] || '';
                      return (
                        <div 
                          class="relative flex items-center space-x-3 sm:space-x-4 rounded-xl p-4 sm:p-6 border border-gray-200 border-l-4 border-l-primary-500 transform translate-x-8 opacity-0 shadow-sm hover:shadow-md transition-all duration-300 overflow-hidden min-h-[70px] sm:min-h-[80px]" 
                          data-animate="card-slide" 
                          data-delay={1000 + (locationIndex * 100)}
                          style={`background-image: url('${bgImage}'); background-size: cover; background-position: center; background-repeat: no-repeat;`}
                        >
                          <div class="absolute inset-0 bg-white/25 backdrop-blur-sm"></div>
                          <div class="relative z-10 flex items-center space-x-3 sm:space-x-4">
                            <div class="w-2.5 h-2.5 sm:w-3 sm:h-3 bg-primary-500 rounded-full flex-shrink-0 pulse-dot"></div>
                            <span class="font-semibold text-base sm:text-lg text-gray-900">{location}</span>
                          </div>
                        </div>
                      );
                    })}
                  </div>
                )}

                {service.ecommerceServices && (
                  <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6 mt-12">
                    {service.ecommerceServices.map((eservice, eserviceIndex) => (
                      <div class="flex items-center space-x-3 sm:space-x-4 bg-gray-50 rounded-xl p-4 sm:p-6 border border-gray-200 border-l-4 border-l-primary-500 transform translate-x-8 opacity-0 shadow-sm hover:shadow-md transition-shadow" data-animate="card-slide" data-delay={1000 + (eserviceIndex * 100)}>
                        <div class="w-2.5 h-2.5 sm:w-3 sm:h-3 bg-primary-500 rounded-full flex-shrink-0 pulse-dot"></div>
                        <span class="font-semibold text-base sm:text-lg">{eservice}</span>
                      </div>
                    ))}
                  </div>
                )}

                {service.technologies && (
                  <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6 mt-12">
                    {service.technologies.map((tech, techIndex) => (
                      <div class="flex items-center space-x-3 sm:space-x-4 bg-gray-50 rounded-xl p-4 sm:p-6 border border-gray-200 border-l-4 border-l-primary-500 transform translate-x-8 opacity-0 shadow-sm hover:shadow-md transition-shadow" data-animate="card-slide" data-delay={1000 + (techIndex * 100)}>
                        <div class="w-2.5 h-2.5 sm:w-3 sm:h-3 bg-primary-500 rounded-full flex-shrink-0 pulse-dot"></div>
                        <span class="font-semibold text-base sm:text-lg">{tech}</span>
                      </div>
                    ))}
                  </div>
                )}
              </div>
              
              <!-- Área visual con animaciones dinámicas -->
              <div class="relative transform scale-90 opacity-0" data-animate="visual-zoom" data-delay="1000">
                <div class="text-center space-y-6 md:space-y-8">
                  <div class="inline-flex items-center justify-center w-16 h-16 sm:w-20 sm:h-20 md:w-24 md:h-24 lg:w-28 lg:h-28 bg-primary-50 rounded-full border-2 border-primary-100 shadow-lg" data-animate="icon-glow" data-delay="1200">
                    <img src={getIconSrc(service.id)} alt="" aria-hidden="true" class="opacity-90 icon-pulse w-8 h-8 sm:w-12 sm:h-12 md:w-14 md:h-14 lg:w-16 lg:h-16 object-contain" width="64" height="64" loading="lazy" decoding="async" />
                  </div>
                  <h3 class="text-2xl sm:text-3xl md:text-4xl font-bold text-primary-500 transform translate-y-4 opacity-0" data-animate="visual-title" data-delay="1400">
                    {service.id === 'almacenamiento' && 'Gestión Avanzada'}
                    {service.id === 'distribucion' && 'Cobertura Total'}
                    {service.id === 'ecommerce' && 'E-commerce Ready'}
                    {service.id === 'tecnologia' && 'Innovación Continua'}
                  </h3>
                  <div class="relative w-full max-w-xs sm:max-w-sm md:max-w-md lg:max-w-lg mx-auto transform scale-90 opacity-0" data-animate="image-reveal" data-delay="1600">
                    {service.id === 'distribucion' ? (
                      <img 
                        src="/gift/MONTACARGA-ASL.gif" 
                        alt={`Animación de ${service.title}`} 
                        class="w-full h-auto rounded-xl sm:rounded-2xl shadow-xl sm:shadow-2xl border border-primary-500/10 hover:shadow-3xl transition-all duration-500" 
                        width="600" 
                        height="400" 
                        loading="lazy" 
                      />
                    ) : (
                      <img 
                        src={getImageSrc(service.id)} 
                        alt={`Imagen de ${service.title}`} 
                        class="w-full h-auto rounded-xl sm:rounded-2xl shadow-xl sm:shadow-2xl border border-primary-500/10 hover:shadow-3xl transition-all duration-500" 
                        width="600" 
                        height="400" 
                        loading="lazy" 
                        decoding="async"
                      />
                    )}
                    <div class="absolute inset-0 bg-gradient-to-t from-black/5 to-transparent rounded-xl sm:rounded-2xl pointer-events-none"></div>
                  </div>
                </div>
              </div>
            </div>
          )}

          {service.id === 'contacto' && (
            <div class="text-center space-y-12">
              <img src={getIconSrc(service.id)} alt={service.title} class="mx-auto mb-8 icon-entrance w-20 h-20 md:w-24 md:h-24 lg:w-28 lg:h-28 object-contain" data-animate="icon-bounce" data-delay="0" width="112" height="112" loading="lazy" decoding="async" />
              <h2 class="text-4xl sm:text-5xl md:text-6xl lg:text-7xl xl:text-8xl font-black mb-6 leading-tight text-primary-500" data-animate="title-slide" data-delay="200">
                {service.title}
              </h2>
              <div class="h-2 w-24 sm:w-32 bg-primary-500 mx-auto rounded-full transform scale-x-0" data-animate="line-expand" data-delay="400"></div>
              <p class="text-xl sm:text-2xl md:text-3xl lg:text-4xl font-light mb-8 opacity-90 text-primary-400" data-animate="subtitle-fade" data-delay="600">
                {service.subtitle}
              </p>
              <p class="text-lg sm:text-xl md:text-2xl lg:text-3xl max-w-4xl mx-auto leading-relaxed opacity-80 mb-16" data-animate="desc-rise" data-delay="800">
                {service.description}
              </p>
              
              <!-- CTAs con animaciones llamativas -->
              <div class="flex flex-col sm:flex-row gap-3 sm:gap-4 md:gap-6 lg:gap-8 justify-center items-center w-full max-w-2xl mx-auto" data-animate="cta-appear" data-delay="1000">
                <Button 
                  href="/contact" 
                  size="lg"
                  class="w-full sm:w-auto bg-primary-500 hover:bg-primary-600 text-white font-bold px-4 sm:px-6 md:px-8 lg:px-12 py-3 sm:py-4 md:py-5 lg:py-6 text-base sm:text-lg md:text-xl lg:text-2xl rounded-xl sm:rounded-2xl shadow-2xl hover:shadow-primary-500/25 transition-all duration-300 transform hover:scale-105 cta-pulse"
                >
                  Solicitar Consultoría Gratuita
                </Button>
                <Button 
                  href="tel:+57-311-123-4567" 
                  variant="outline" 
                  size="lg"
                  class="w-full sm:w-auto border-2 border-primary-500 text-primary-400 hover:bg-primary-500 hover:text-white font-bold px-4 sm:px-6 md:px-8 lg:px-12 py-3 sm:py-4 md:py-5 lg:py-6 text-base sm:text-lg md:text-xl lg:text-2xl rounded-xl sm:rounded-2xl transition-all duration-300 transform hover:scale-105"
                >
                  Llamar Ahora
                </Button>
              </div>
            </div>
          )}
        </div>
      </div>

  </section>
  ))}
</div>

<style>
  /* Scroll-snap inmersivo */
  body.scrolly-enabled {
    scroll-snap-type: y proximity;
    scroll-behavior: smooth;
  }
  
  .scrollytelling-container {}
  
  .scrolly-section {
    scroll-snap-align: start;
    scroll-snap-stop: normal;
    transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  }
  
  /* Efectos de parallax en secciones */
  .section-parallax {
    will-change: transform;
  }
  
  .section-overlay {
    transition: opacity 0.5s ease-in-out;
  }
  
  .section-accent {
    transition: transform 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55);
  }
  
  .section-accent.active {
    transform: scaleY(1);
  }
  
  /* Dots de navegación más dinámicos */
  .nav-dot.active {
    background-color: theme('colors.primary.500') !important;
    transform: scale(1.4);
    box-shadow: 0 0 0 6px rgba(202,36,28,0.2), 0 0 20px rgba(202,36,28,0.4);
  }
  
  /* Asegurar que las secciones ocupen toda la pantalla */
  .scrolly-section {
    min-height: 100vh;
    min-height: 100dvh;
  }
  
  /* Animaciones DINÁMICAS y VISIBLES */
  [data-animate] { 
    opacity: 0; 
    will-change: transform, opacity;
  }
  .animated { opacity: 1; }
  
  /* Animaciones de títulos */
  .animated.title-slide { animation: titleSlide 1.2s cubic-bezier(0.175, 0.885, 0.32, 1.275) both; }
  .animated.title-sweep { animation: titleSweep 1s cubic-bezier(0.68, -0.55, 0.265, 1.55) both; }
  .animated.subtitle-fade { animation: subtitleFade 1s cubic-bezier(0.25, 0.46, 0.45, 0.94) both; }
  .animated.subtitle-rise { animation: subtitleRise 1s cubic-bezier(0.175, 0.885, 0.32, 1.275) both; }
  
  /* Animaciones de iconos - MÁS DISCRETAS */
  .animated.icon-bounce { animation: iconBounce 1s ease-out both; }
  .animated.icon-spin { animation: iconSpin 0.8s ease-out both; }
  .animated.icon-glow { animation: iconGlow 0.8s ease-out both; }
  
  /* Animaciones de elementos */
  .animated.line-expand { animation: lineExpand 1s cubic-bezier(0.68, -0.55, 0.265, 1.55) both; }
  .animated.desc-rise { animation: descRise 1s cubic-bezier(0.25, 0.46, 0.45, 0.94) both; }
  .animated.desc-fade { animation: descFade 1s cubic-bezier(0.25, 0.46, 0.45, 0.94) both; }
  .animated.stat-pop { animation: statPop 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55) both; }
  .animated.card-slide { animation: cardSlide 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275) both; }
  .animated.visual-zoom { animation: visualZoom 1.2s cubic-bezier(0.175, 0.885, 0.32, 1.275) both; }
  .animated.visual-title { animation: visualTitle 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94) both; }
  .animated.image-reveal { animation: imageReveal 1s cubic-bezier(0.175, 0.885, 0.32, 1.275) both; }
  .animated.cta-appear { animation: ctaAppear 1s cubic-bezier(0.68, -0.55, 0.265, 1.55) both; }

  /* Definición de keyframes */
  @keyframes titleSlide {
    0% { transform: translateY(-40px) scale(0.9); opacity: 0; }
    100% { transform: translateY(0) scale(1); opacity: 1; }
  }
  @keyframes titleSweep {
    0% { transform: translateX(-48px) scale(0.95); opacity: 0; }
    100% { transform: translateX(0) scale(1); opacity: 1; }
  }
  @keyframes subtitleFade {
    0% { transform: translateY(20px); opacity: 0; }
    100% { transform: translateY(0); opacity: 1; }
  }
  @keyframes subtitleRise {
    0% { transform: translateY(32px); opacity: 0; }
    100% { transform: translateY(0); opacity: 1; }
  }
  @keyframes iconBounce {
    0% { transform: scale(0.8) translateY(10px); opacity: 0; }
    50% { transform: scale(1.05) translateY(-2px); }
    100% { transform: scale(1) translateY(0); opacity: 1; }
  }
  @keyframes iconSpin {
    0% { transform: scale(0.9) rotate(-45deg); opacity: 0; }
    100% { transform: scale(1) rotate(0deg); opacity: 1; }
  }
  @keyframes iconGlow {
    0% { transform: scale(0.95); opacity: 0; filter: brightness(0.8); }
    100% { transform: scale(1); opacity: 1; filter: brightness(1); }
  }
  @keyframes lineExpand {
    0% { transform: scaleX(0); }
    100% { transform: scaleX(1); }
  }
  @keyframes descRise {
    0% { transform: translateY(24px); opacity: 0; }
    100% { transform: translateY(0); opacity: 1; }
  }
  @keyframes descFade {
    0% { transform: translateY(48px); opacity: 0; }
    100% { transform: translateY(0); opacity: 1; }
  }
  @keyframes statPop {
    0% { transform: scale(0); opacity: 0; }
    50% { transform: scale(1.2); }
    100% { transform: scale(1); opacity: 1; }
  }
  @keyframes cardSlide {
    0% { transform: translateX(32px) scale(0.95); opacity: 0; }
    100% { transform: translateX(0) scale(1); opacity: 1; }
  }
  @keyframes visualZoom {
    0% { transform: scale(0.3); opacity: 0; }
    100% { transform: scale(1); opacity: 1; }
  }
  @keyframes visualTitle {
    0% { transform: translateY(16px); opacity: 0; }
    100% { transform: translateY(0); opacity: 1; }
  }
  @keyframes imageReveal {
    0% { transform: scale(0.9) rotateY(90deg); opacity: 0; }
    100% { transform: scale(1) rotateY(0deg); opacity: 1; }
  }
  @keyframes ctaAppear {
    0% { transform: translateY(40px) scale(0.8); opacity: 0; }
    100% { transform: translateY(0) scale(1); opacity: 1; }
  }

  /* Animaciones continuas */
  .icon-float { animation: iconFloat 4s ease-in-out infinite; }
  .icon-pulse { animation: iconPulse 3s ease-in-out infinite; }
  .pulse-dot { animation: pulseDot 2s ease-in-out infinite; }
  .cta-pulse { animation: ctaPulse 2s ease-in-out infinite; }
  
  /* Efectos hover para imágenes */
  img:hover {
    transform: scale(1.02);
    transition: transform 0.3s ease;
  }
  
  @keyframes iconFloat {
    0%, 100% { transform: translateY(0) rotate(0deg); }
    50% { transform: translateY(-4px) rotate(2deg); }
  }
  @keyframes iconPulse {
    0%, 100% { transform: scale(1); filter: brightness(1); }
    50% { transform: scale(1.02); filter: brightness(1.05); }
  }
  @keyframes pulseDot {
    0%, 100% { transform: scale(1); opacity: 1; }
    50% { transform: scale(1.3); opacity: 0.7; }
  }
  /* Animación de imagen mejorada */
  @keyframes imageHover {
    0% { transform: scale(1) rotate(0deg); }
    100% { transform: scale(1.02) rotate(0.5deg); }
  }
  @keyframes ctaPulse {
    0%, 100% { box-shadow: 0 10px 30px rgba(202,36,28,0.3); }
    50% { box-shadow: 0 15px 40px rgba(202,36,28,0.5); }
  }

  /* Animaciones circulares suaves y fluidas */
  @keyframes circularRotate {
    0% {
      transform: rotate(0deg);
    }
    100% {
      transform: rotate(360deg);
    }
  }
  
  @keyframes circularAppear {
    0% {
      opacity: 0;
      transform: translate(-50%, -50%) scale(0.5) rotate(0deg);
    }
    100% {
      opacity: 1;
      transform: translate(-50%, -50%) scale(1) rotate(0deg);
    }
  }
  
  @keyframes floatCard {
    0%, 100% {
      transform: translate(-50%, -50%) translateY(0px) rotate(0deg);
    }
    50% {
      transform: translate(-50%, -50%) translateY(-6px) rotate(0deg);
    }
  }
  
  /* Contenedor principal con rotación suave */
  .circular-container {
    animation: circularRotate 60s linear infinite;
    transform-origin: center center;
    backface-visibility: hidden;
    perspective: 1000px;
  }
  
  .circular-container:hover {
    animation-play-state: paused;
  }
  
  /* Tarjetas con animaciones optimizadas */
  .feature-card {
    animation: circularAppear 1s ease-out forwards;
    opacity: 0;
    will-change: transform;
    transform-origin: center center;
    backface-visibility: hidden;
    transform-style: preserve-3d;
  }
  
  .feature-card:hover {
    z-index: 50;
    transform: translate(-50%, -50%) scale(1.1) !important;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  /* Contrarotación perfectamente sincronizada */
  .card-content {
    animation: circularRotate 60s linear infinite reverse;
    will-change: transform;
    transform-origin: center center;
    backface-visibility: hidden;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100%;
    width: 100%;
  }
  
  .circular-container:hover .card-content {
    animation-play-state: paused;
  }
  
  /* Mejoras visuales adicionales */
  .feature-card:hover .card-content {
    animation-play-state: paused;
  }
  
  /* Optimizaciones responsive */
  @media (max-width: 768px) {
    .circular-container {
      animation-duration: 50s;
    }
    .card-content {
      animation-duration: 50s;
    }
  }
  
  @media (max-width: 640px) {
    .circular-container {
      animation-duration: 45s;
    }
    .card-content {
      animation-duration: 45s;
    }
  }

  /* Accesibilidad: reducir movimiento */
  @media (prefers-reduced-motion: reduce) {
    .animated.title-slide,
    .animated.title-sweep,
    .animated.subtitle-fade,
    .animated.subtitle-rise,
    .animated.icon-bounce,
    .animated.icon-spin,
    .animated.icon-glow,
    .animated.line-expand,
    .animated.desc-rise,
    .animated.desc-fade,
    .animated.stat-pop,
    .animated.card-slide,
    .animated.visual-zoom,
    .animated.visual-title,
    .animated.image-reveal,
    .animated.cta-appear,
    .icon-float,
    .icon-pulse,
    .pulse-dot,
    .cta-pulse {
      animation: none !important;
      opacity: 1 !important;
      transform: none !important;
    }
  }

  /* Responsive adjustments */
  @media (max-width: 640px) {
    .scrolly-section {
      padding: 1rem;
      min-height: 100vh;
    }
    
    .container {
      padding-left: 1rem;
      padding-right: 1rem;
    }
    
    /* Títulos responsivos para móvil */
    h2 {
      font-size: 2.5rem !important;
      line-height: 1.1 !important;
    }
    
    /* Subtítulos responsivos */
    .text-xl {
      font-size: 1.125rem !important;
    }
    
    /* Descripciones responsivas */
    .text-lg {
      font-size: 1rem !important;
    }
  }
  
  @media (min-width: 641px) and (max-width: 768px) {
    .scrolly-section {
      padding: 1.5rem;
      min-height: 100vh;
    }
    
    .container {
      padding-left: 1.5rem;
      padding-right: 1.5rem;
    }
    
    /* Títulos para tablet */
    h2 {
      font-size: 3.5rem !important;
    }
  }
  
  @media (min-width: 769px) and (max-width: 1024px) {
    .scrolly-section {
      padding: 2rem;
      min-height: 100vh;
    }
    
    .container {
      padding-left: 2rem;
      padding-right: 2rem;
    }
  }
  
  @media (min-width: 1025px) {
    .scrolly-section {
      padding: 3rem;
      min-height: 100vh;
    }
    
    .container {
      padding-left: 3rem;
      padding-right: 3rem;
    }
  }
  
  /* Grid responsive adjustments */
  @media (max-width: 640px) {
    .grid.lg\:grid-cols-2 {
      grid-template-columns: 1fr;
      gap: 1.5rem;
    }
    
    .grid.grid-cols-3 {
      grid-template-columns: 1fr;
      gap: 1rem;
    }
    
    .grid.sm\:grid-cols-2 {
      grid-template-columns: 1fr;
      gap: 1rem;
    }
    
    /* Ajustes para tarjetas en móvil */
    .grid.grid-cols-2 {
      grid-template-columns: 1fr 1fr;
      gap: 0.75rem;
    }
  }
  
  @media (min-width: 641px) and (max-width: 767px) {
    .grid.grid-cols-2 {
      grid-template-columns: 1fr 1fr 1fr;
      gap: 1rem;
    }
  }
  
  @media (min-width: 641px) and (max-width: 1023px) {
    .grid.lg\:grid-cols-2 {
      grid-template-columns: 1fr;
      gap: 2rem;
    }
  }
  
  /* Mejoras específicas para el diseño circular responsivo */
  @media (max-width: 768px) {
    .circular-container {
      display: none;
    }
  }
  
  /* Optimizaciones para imágenes responsivas */
  @media (max-width: 640px) {
    img {
      max-width: 100%;
      height: auto;
    }
    
    .w-20, .w-24 {
      width: 4rem !important;
    }
    
    /* Navegación lateral responsiva */
    .nav-dots {
      right: 0.5rem !important;
      gap: 0.5rem !important;
    }
    
    .nav-dot {
      width: 0.75rem !important;
      height: 0.75rem !important;
    }
    
    /* Botones responsivos */
    .cta-pulse {
      animation-duration: 3s !important;
    }
  }
  
  @media (min-width: 641px) and (max-width: 768px) {
    .nav-dots {
      right: 1rem !important;
    }
    
    .nav-dot {
      width: 1rem !important;
      height: 1rem !important;
    }
  }
  
  /* Mejoras para accesibilidad táctil */
  @media (max-width: 768px) {
    .nav-dot {
      min-width: 44px;
      min-height: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .nav-dot::before {
      content: '';
      width: 12px;
      height: 12px;
      background-color: currentColor;
      border-radius: 50%;
    }
  }
</style>

<script>
  // Mantener scroll del documento, navbar fluido y animaciones discretas
  document.addEventListener('DOMContentLoaded', function() {
    const sections = document.querySelectorAll('.scrolly-section');
    const navDots = document.querySelectorAll('.nav-dot');

    // Activar scroll-snap en body solo en esta página
    document.body.classList.add('scrolly-enabled');

    // Navbar: mantener comportamiento de esta página (transparente -> sólido al scrollear)
    const nav = document.querySelector('nav');
    const onScroll = () => {
      if (window.scrollY > 10) {
        nav?.classList.add('navbar-scrolled');
      } else {
        nav?.classList.remove('navbar-scrolled');
      }
    };
    onScroll();
    window.addEventListener('scroll', onScroll, { passive: true });

    // Observador de intersección para activar indicadores y animaciones
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          const sectionId = entry.target.getAttribute('data-section');
          // Actualizar indicadores
          navDots.forEach(dot => {
            dot.classList.remove('active');
            if (dot.getAttribute('data-target') === sectionId) {
              dot.classList.add('active');
            }
          });
          // Animaciones discretas - optimizadas para zoom 100%
          const animated = entry.target.querySelectorAll('[data-animate]:not(.animated)');
          animated.forEach((el) => {
            const type = el.getAttribute('data-animate');
            const rawDelay = parseInt(el.getAttribute('data-delay') || '0', 10);
            const delay = Math.min(rawDelay, 200); // reducido para respuesta más rápida
            
            // Forzar repintado para evitar problemas con zoom
            el.style.display = 'none';
            el.offsetHeight; // forzar repintado
            el.style.display = '';
            
            setTimeout(() => {
              el.classList.add('animated', type);
            }, delay);
          });
        }
      });
    }, { threshold: 0.15, rootMargin: "0px 0px -10% 0px" });

    sections.forEach(section => observer.observe(section));

    // Navegación con clicks en los dots
    navDots.forEach(dot => {
      dot.addEventListener('click', function() {
        const targetId = this.getAttribute('data-target');
        const targetSection = document.getElementById(targetId);
        if (targetSection) {
          targetSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
      });
    });

    // Navegación con teclado (flechas arriba/abajo)
    document.addEventListener('keydown', function(e) {
      if (e.key === 'ArrowDown' || e.key === 'ArrowUp') {
        e.preventDefault();
        const currentActive = document.querySelector('.nav-dot.active');
        if (!currentActive) return;
        const currentIndex = Array.from(navDots).indexOf(currentActive);
        let nextIndex;
        if (e.key === 'ArrowDown') {
          nextIndex = currentIndex < navDots.length - 1 ? currentIndex + 1 : currentIndex;
        } else {
          nextIndex = currentIndex > 0 ? currentIndex - 1 : currentIndex;
        }
        if (nextIndex !== currentIndex) {
          navDots[nextIndex].click();
        }
      }
    });

    // Limpieza cuando el usuario salga de la página
    window.addEventListener('beforeunload', () => {
      document.body.classList.remove('scrolly-enabled');
      window.removeEventListener('scroll', onScroll);
    });
  });
</script>